<!doctype html>
<html class="no-js" lang="">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<title>Election Calendar</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<style>
		body {
			font-family: Helvetica, sans-serif;
			font-size: 1rem;
			line-height: 1.8rem;
		}
		.has-blue-background-color {
			background-color: #114984;
		}
		</style>
	</head>
	<body>
<!--
	WELCOME TO THE ELECTION CALENDAR WIDGET

	This code displays a 3-month calendar with key election dates. On
	mobile, the 3 months stay horizontal and become scrollable while
	the events become a vertical list.

	To use, copy everything *inside* the <body> tag, all 450+ lines of
	it. Create a Custom HTML element on a page in your Wordpress site.
	Then just paste it all in there. Click Update, and you're done.

	You will want to edit the events array just below here to contain
	all of the relevant election dates and deadlines for your
	jurisdiction. Update the links to point to relevant pages of your
	county clerk's site. Then change the startWithMonth and
	lengthOfTime.startDate. Finally, you may want to tweak the colors
	in the <style> section toward the bottom.
-->

<!-- Election Calendar div -->
<div id="election-cal"></div>


<!-- Create Election Calendar Javascript -->
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {

	// Setup options
	// General by default
	var clndrOptions = {
			template: $('#clndr-multimonth-template').html(),
			showAdjacentMonths: false,
			startWithMonth: "2020-09-01",
			events: [
				{
					// Next day after ballots begin to be sent
					title: "VBM ballots begin to arrive",
					date:  "2020-09-24",
					type:  "vbm",
					link:  "http://www.volusiaelections.org/ElectionInformation/absenteerequest.htm",
					icon:  '<i class="fas fa-envelope-open-text"></i>'
				}, {
					title: "Deadline to register",
					date:  "2020-10-05",
					type:  "registration",
					link:  "http://www.volusiaelections.org/VoterRegistration/registrationdeadline.htm",
					icon:  '<i class="fas fa-landmark"></i>'
				}, {
					// Early Voting: https://dos.myflorida.com/elections/for-voters/voting/early-voting/
					title: "Early Voting",
					start: "2020-10-19",
					end:   "2020-11-01",
					type:  "early-voting",
					link:  "http://www.volusiaelections.org/EarlyVoting/default.htm",
					icon:  '<i class="fas fa-clock"></i>'
				}, {
					title: "Deadline to request VBM ballot, in person",
					date:  "2020-11-01",
					type:  "vbm",
					link:  "http://www.volusiaelections.org/ElectionInformation/absenteerequest.htm",
					icon:  '<i class="fas fa-landmark"></i>'
				}, {
					title: "Deadline to return VBM ballot",
					date:  "2020-10-31",
					type:  "vbm",
					link:  "http://www.volusiaelections.org/ElectionInformation/absenteereturn.htm",
					icon:  '<i class="fas fa-inbox"></i>'
				}, {
					title: "Election Day!",
					date:  "2020-11-03",
					type:  "election",
					link:  "http://www.volusiaelections.org/ElectionInformation/election_calendar.html",
					icon:  '<i class="fas fa-vote-yea"></i>'
				}
			],
			multiDayEvents: {
				startDate: "start",
				endDate:   "end",
				singleDay: "date"
			},
			lengthOfTime: {
				months: 3,
				interval: 3,
				startDate: "2020-09-01"
			},
			clickEvents: {
				click: clickElectionEvent
			},
			doneRendering: doneRendering,
			ready: readyHandler
		};

	// 
	// Post-General calendar
	// 
	// if (moment().isAfter('2020-11-03'))
	// {
		// If you want to put a message up once the election is over, that goes here.
	// } else

	// 
	// General calendar
	// 
	if (moment().isAfter('2020-08-18'))
	{
		$('#election-cal').clndr(clndrOptions);
	}

	// 
	// Primary calendar
	// 
	else {
		/* Fix up dates for the general */
		clndrOptions.startWithMonth         = "2020-06-01";
		clndrOptions.lengthOfTime.startDate = "2020-06-01";

		clndrOptions.events[0].date  = "2020-06-25"; /* VBM starts arriving */
		clndrOptions.events[1].date  = "2020-07-20"; /* Registration deadline */
		clndrOptions.events[2].start = "2020-08-08"; /*   Early voting start */
		clndrOptions.events[2].end   = "2020-08-15"; /*   Early voting end */  
		clndrOptions.events[3].date  = "2020-08-15"; /* VBM request deadline */
		clndrOptions.events[4].date  = "2020-08-16"; /* VBM return deadline */
		clndrOptions.events[5].date  = "2020-08-18"; /* Election day */

		$('#election-cal').clndr(clndrOptions);
	}


	function clickElectionEvent(target) {
		// Nothing to see here.
		// if (target.events) {
		// 	window.location = target.events[0].link;
		// }
	}

	function doneRendering() {
		// Load the moment-range extension
		window['moment-range'].extendMoment(moment);

		// Add event type classes
		// https://github.com/kylestetz/CLNDR/issues/335#issuecomment-650769056
		
		for (let event of this.options.events) {
			// Single-day events
			if (event.date) {
				mydate = event.date;
				mytype = event.type;
				let dayEl = $('.day.calendar-day-'+mydate);
				dayEl.addClass(mytype);

				if (event.icon) {
					let iconContainerEl = dayEl;

					// If there's already a link, we have to put the icon inside of it
					if (dayEl.hasClass('has-link')) {
						aEl = dayEl.find('a');
						iconContainerEl = aEl;
					}

					// Only add the icon if there isn't one already
					if (!dayEl.hasClass('has-icon')) {
						iconContainerEl.append(`<span class="icon">${event.icon}</span>`);
						dayEl.addClass('has-icon');
					}
				}

				if (event.link) {
					if (dayEl.hasClass('has-link')) {
						aEl = dayEl.find('a');
						aEl.attr('href', event.link);
					} else {
						dayEl.wrapInner(`<a href="${event.link}"></a>`)
						dayEl.addClass('has-link');
					}
				}
			}

			// Multi-day events
			else {
				const range = moment.range(event.start, event.end);

				for (let day of range.by('day')) {
					mydate = day.format('YYYY-MM-DD');
					mytype = event.type;

					let dayEl = $('.day.calendar-day-'+mydate);
					dayEl.addClass(mytype);

					// Add in the icon on the starting date
					if (event.icon && mydate == event.start) {
						dayEl.append(`<span class="icon">${event.icon}</span>`);
						dayEl.addClass('has-icon');
					}

					if (event.link) {
						dayEl.contents().not("a").wrapAll(`<a href="${event.link}"></a>`);
						dayEl.addClass('has-link');
					}
				}
			}
		}
	}

	function readyHandler() {
		var self = this;
		$(this.element).on('mouseenter', '.day', function(e) {
			var target = self.buildTargetObject(e.currentTarget, true);
			if (target.events.length) {
				for (let event of target.events) {
					var startdate = event.date ? event.date : event.start;
					var event_item_class = 'event-item-'+moment(startdate).format('YYYY-MM-DD');
					$(`.${event_item_class}`).addClass('active-event');
				}
			}
		});
		$(this.element).on('mouseleave', '.day', function(e) {
			var target = self.buildTargetObject(e.currentTarget, true);
			if (target.events.length) {
				for (let event of target.events) {
					var startdate = event.date ? event.date : event.start;
					var event_item_class = 'event-item-'+moment(startdate).format('YYYY-MM-DD');
					$(`.${event_item_class}`).removeClass('active-event');
				}
			}
		});
	}
});
</script>


<!--
	Election Calendar Template

	This is the template used by CLNDR to generate the calendar.
-->
 <script type="text/template" id="clndr-multimonth-template">
	<div class="months-scroller">
	<div class="months-container">
	<% _.each(months, function (oneMonth) { %>
	<div class="month">
		<div class="controls">
			<div class="month-header"><%= oneMonth.month.format('MMMM YYYY') %></div>
		</div>
		<div class="days-container">
			<div class="days">
				<div class="headers has-blue-background-color">
				<% _.each(daysOfTheWeek, function (day) { %>
					<div class="day-header"><%= day %></div>
				<% }); %>
				</div>
			<% _.each(oneMonth.days, function (day) { %>
				<div class="<%= day.classes %>"><span class="number"><%= day.day %></span></div>
			<% }); %>
			</div>
		</div>
	</div>
	<% }); %>
	</div>
	</div>
	<div class="flex-item events">
		<% var seenEarlyVoting = false;
			_.each(eventsThisInterval, function(month) {
			_.each(month, function(event) {
				if (event.date) { %>
				<div class="event-item <%= event.type %> <%= 'event-item-'+moment(event.date).format('YYYY-MM-DD') %>">
					<div class="event-item-date"><%= moment(event.date).format('MMM Do') %></div>
					<div class="event-item-title"><%= event.title %></div>
					<div class="event-item-link"><a href="<%= event.link %>">Learn More</a></div>
				</div>
				<% } else if (!seenEarlyVoting) { %>
				<div class="event-item <%= event.type %> <%= 'event-item-'+moment(event.start).format('YYYY-MM-DD') %>">
					<div class="event-item-date"><%= moment(event.start).format('MMM Do') %>&ndash;<%= moment(event.end).format('MMM Do') %></div>
					<div class="event-item-title"><%= event.title %></div>
					<div class="event-item-link"><a href="<%= event.link %>">Learn More</a></div>
				</div>
				<%
					// In the general, early voting stops in November. Helpfully, CLNDR returns the event
					// twice, once for Oct and again for Nov. So we have to ignore the second one.
					seenEarlyVoting = true;
				} %>
			<% });
		}); %>
	</div>
</script>




<!--
	Election Calendar CSS

	Heavily modified from the example on the CLNDR site.
-->
<style type="text/css" id="less:CLNDR-css-clndr">
#election-cal {
/*	@import url(https://fonts.googleapis.com/css?family=Asap:400,700);
	font-family: Asap, Helvetica, Arial;
*/	margin: 0 auto;
}
#election-cal .clndr {
	max-width: 59rem;
	margin: auto;
	
	/* Flex */
	display: flex;
	align-content: flex-start;
	justify-content: center;
	flex-wrap: wrap;
}
/*	Needed to fix the "missing last-item right padding" problem.
	See https://stackoverflow.com/a/26892899/1749551 */
#election-cal .clndr .months-scroller {
	overflow-x: auto;
	width: 100%;
}
#election-cal .clndr .months-container {
	display: flex;
	flex-direction: row;
	box-sizing: border-box;
	min-width: 100%;
	height: 17rem;
	float: left;
}
#election-cal .clndr .month {
	width: 280px;
	flex: 0 1 auto;
	margin: 0 1rem;
}
#election-cal .clndr .flex-item {
	display: flex;
	flex-wrap: wrap;
	align-items: flex-start;
	align-content: flex-start;
}
#election-cal .clndr .controls {
	width: 100%;
	background-color: white;
	color: black;
}

#election-cal .clndr .controls .month-header {
	width: 100%;
	padding-top: 5px;
	padding-bottom: 5px;
	text-align: center;
	/*text-transform: uppercase;*/
	font-weight: 500;
	letter-spacing: 1px;
}
#election-cal .clndr .days-container {
	width: 100%;
	flex: 1;
	
	display: inline-block;
}
#election-cal .clndr .days-container .days {
	width: 100%;
	/*height: 217px;*/
	-webkit-transition: left 0.5s;
	-moz-transition: left 0.5s;
	-ms-transition: left 0.5s;
	-o-transition: left 0.5s;
	transition: left 0.5s;
	background-color: #ebebeb;

	display: flex;
	flex-wrap: wrap;
}
#election-cal .clndr .days-container .days .day,
#election-cal .clndr .days-container .days .empty {
	width: 40px;
	height: 31px;
	font-size: 12px;
	text-align: center;
	color: #212121;
	border-right: 1px solid rgba(255, 255, 255, 0.5);
	border-bottom: 1px solid rgba(255, 255, 255, 0.5);

	flex: 1 0 auto;
	display: flex;
	align-items: center;
	justify-content: center;
}
#election-cal .clndr .days-container .days .day.today {
	border: 1px solid black;
}
#election-cal .clndr .days-container .days .day.event,
#election-cal .clndr .days-container .days .empty.event {
	background-color: #f5f5f5;
	-webkit-transition: background-color 0.5s;
	-moz-transition: background-color 0.5s;
	-ms-transition: background-color 0.5s;
	-o-transition: background-color 0.5s;
	transition: background-color 0.5s;
	cursor: pointer;
}
#election-cal .clndr .days-container .days .day.event.has-icon a .number {
	display: none;
}
#election-cal .clndr .days-container .days .day.event.has-icon:hover a .number {
	display: inline-block;
}
#election-cal .clndr .days-container .days .day.event a .icon {
	display: inline-block;
	font-size: 14pt;
}
#election-cal .clndr .days-container .days .day.event:hover a .icon {
	display: none;
}
#election-cal .clndr .days-container .days .day.event:hover,
#election-cal .clndr .days-container .days .empty.event:hover {
	background-color: #b8b8b8;
}
#election-cal .clndr .days-container .days .day.event a {
	width: 100%;
	height: 100%;

	display: flex;
	align-items: center;
	justify-content: center;
}
#election-cal .clndr .days-container .days .empty {
	height: 31px;
	vertical-align: bottom;
}
#election-cal .clndr .days-container .days .headers {
	padding-top: 5px;
	padding-bottom: 5px;

	display: flex;
}
#election-cal .clndr .days-container .days .headers .day-header {
	width: 40px;
	display: inline-block;
	text-align: center;
	color: white;
}
#election-cal .clndr .events {
	width: 100%;
	height: 17rem;
	/*margin-top: 1rem;*/

	display: flex;
	flex-direction: column;
	justify-content: flex-start;
	align-content: flex-start;
}
.event-item {
	width: 19.5rem;
	padding: 1rem;

	border: 2px solid white;
}
.event-item-date {
	font-weight: bold;
}
#election-cal .clndr .events .active-event {
	border: 2px solid #c21e2d;
	border-radius: 3px;
}
@media screen and (max-width: 400px) {
	#election-cal .clndr .events {
		height: auto;
	}
	#election-cal .clndr .events .active-event {
		order: -1;
	}
	#election-cal .clndr .days-container .days .day.event a {
		pointer-events: none;
		text-decoration: none;
	}
}
#election-cal * {
	box-sizing: border-box;
	-moz-box-sizing: border-box;
	-webkit-box-sizing: border-box;
}
</style>



<!--
	Dependencies
-->

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-3.2.1.min.js"><\/script>')</script>

<!-- Various other libraries needed by the above JS code. Order matters. -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.10.2/underscore-min.js" integrity="sha256-av1TvywtZ4ZqyCj/6HdtCHSJdn80HAzTgEBTJt/O8uc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/moment.min.js" integrity="sha256-ZsWP0vT+akWmvEMkNYgZrPHKU9Ke8nYBPC3dqONp1mY=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment-range/4.0.2/moment-range.js" integrity="sha256-bB6c2ZfNzG6Tv8MSu/pqUl0y91h86M/T+1w0WrCZhGw=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clndr/1.5.1/clndr.min.js" integrity="sha256-5l9tTVIIDLb0zGv9g1ntQ+L2tuJyfH+bhwRn8ATus4c=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css" integrity="sha256-2XFplPlrFClt0bIdPgpz8H7ojnk10H69xRqd9+uTShA=" crossorigin="anonymous" />


	</body>
</html>